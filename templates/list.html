{% extends "layout.html" %}

{% block title %}출석 명단 - 도서실 출석 시스템{% endblock %}

{% block head %}
<style>
    /* 정렬 가능한 헤더 스타일 */
    th.sortable {
        cursor: pointer;
        transition: all 0.2s;
        user-select: none;
        position: relative;
    }
    
    th.sortable:hover {
        background-color: rgba(0, 123, 255, 0.7);
    }
    
    th.sortable i {
        margin-left: 5px;
        font-size: 0.8rem;
        position: relative;
        top: 1px;
    }
    
    /* 정렬된 행 효과 */
    tbody tr {
        transition: all 0.2s;
    }
    
    /* 정렬 활성화 시 효과 */
    th.sortable.active {
        background-color: #0056b3;
    }
    
    /* 정렬 효과 강조 */
    .fa-sort-up, .fa-sort-down {
        color: #ffc107; /* 노란색으로 강조 */
    }
</style>
{% endblock %}

{% block content %}
<div class="card shadow">
    <div class="card-header bg-secondary text-white d-flex justify-content-between align-items-center">
        <h2 class="h4 mb-0">
            <i class="fas fa-clipboard-list me-2"></i>출석 명단
        </h2>
        <div>
            <a href="/by_period" class="btn btn-sm btn-light me-2">
                <i class="fas fa-clock me-1"></i>교시별 보기
            </a>
            <a href="/export" class="btn btn-sm btn-light me-2">
                <i class="fas fa-file-csv me-1"></i>CSV 다운로드
            </a>
            <a href="/print" class="btn btn-sm btn-light" target="_blank">
                <i class="fas fa-print me-1"></i>인쇄용 보기
            </a>
        </div>
    </div>
    <div class="card-body">
        <div class="table-responsive">
            <table class="table table-hover table-striped" id="attendanceTable">
                <thead class="table-dark">
                    <tr>
                        <th class="sortable" onclick="sortTable('attendanceTable', 0)">출석일 <i class="fas fa-sort"></i></th>
                        <th class="sortable" onclick="sortTable('attendanceTable', 1)">교시 <i class="fas fa-sort"></i></th>
                        <th class="sortable" onclick="sortTable('attendanceTable', 2)">학번 <i class="fas fa-sort"></i></th>
                        <th class="sortable" onclick="sortTable('attendanceTable', 3)">이름 <i class="fas fa-sort"></i></th>
                        <th class="sortable" onclick="sortTable('attendanceTable', 4)">공강좌석번호 <i class="fas fa-sort"></i></th>
                    </tr>
                </thead>
                <tbody>
                    {% if records %}
                        {% for r in records %}
                        <tr>
                            <td>{{ r['출석일_표시'] }}</td>
                            <td>{{ r.get('교시', '-') }}</td>
                            <td>{{ r['학번'] }}</td>
                            <td>{{ r['이름'] }}</td>
                            <td>{{ r['공강좌석번호'] }}</td>
                        </tr>
                        {% endfor %}
                    {% else %}
                        <tr>
                            <td colspan="5" class="text-center py-4">
                                <div class="alert alert-info mb-0">
                                    <i class="fas fa-info-circle me-2"></i>출석 기록이 없습니다.
                                </div>
                            </td>
                        </tr>
                    {% endif %}
                </tbody>
            </table>
        </div>
    </div>
    <div class="card-footer d-flex justify-content-between">
        <a href="/stats" class="btn btn-outline-primary">
            <i class="fas fa-chart-bar me-1"></i>통계 보기
        </a>
        <a href="/" class="btn btn-outline-secondary">
            <i class="fas fa-home me-1"></i>메인 페이지로
        </a>
    </div>
</div>
{% endblock %}

{% block scripts %}
<script src="{{ url_for('static', filename='js/table-sort.js') }}"></script>
{% endblock %}
